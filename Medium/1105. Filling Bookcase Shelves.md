# 1105. Filling Bookcase Shelves

---

## Problem Restatement
We are given `books[i] = [thickness, height]` and a shelf width `shelfWidth`.  
Books must be placed **in order**.  
Each shelf can hold consecutive books until their total thickness ≤ `shelfWidth`.  
The shelf height = maximum height among those books.  
We want to minimize the total height of the bookcase.

---

## Key Idea
This is a **Dynamic Programming** problem.

- Define `dp[i]` = minimum height to place the first `i` books.  
- Transition:  
  - Try to place books `j..i` on the same shelf (where `j ≤ i`).  
  - Keep track of total thickness and max height of that shelf.  
  - Formula:  
    ```
    dp[i] = min(dp[j-1] + maxHeight(j..i)) for all j..i with sumThickness ≤ shelfWidth
    ```
- Answer: `dp[n]`.

---

## Code (C#)
```csharp
public class Solution {
    public int MinHeightShelves(int[][] books, int shelfWidth) {
        int n = books.Length;
        int[] dp = new int[n + 1];
        dp[0] = 0;

        for (int i = 1; i <= n; i++) {
            int width = 0;
            int height = 0;
            dp[i] = int.MaxValue;

            // Try placing books j..i on the same shelf
            for (int j = i; j >= 1; j--) {
                width += books[j - 1][0];
                if (width > shelfWidth) break;

                height = Math.Max(height, books[j - 1][1]);
                dp[i] = Math.Min(dp[i], dp[j - 1] + height);
            }
        }

        return dp[n];
    }
}
```



## Complexity
- **Time:** O(n²), because for each book we may look back at all previous books to decide shelf placement.  
- **Space:** O(n), storing the DP array of minimum heights for prefixes of the book list.  

---

## Example Walkthrough

**Input:** `books = [[1,1],[2,3],[2,3],[1,1],[1,1],[1,1],[1,2]], shelfWidth = 4`  
- Shelf 1: `[1,1]` → height = 1  
- Shelf 2: `[2,3],[2,3]` → height = 3  
- Shelf 3: `[1,1],[1,1],[1,2]` → height = 2  
- **Total height = 1 + 3 + 2 = 6 ✅**

**Input:** `books = [[1,3],[2,4],[3,2]], shelfWidth = 6`  
- Place all books on one shelf: width = 6, height = 4  
- **Total height = 4 ✅**

---

## Why This Works
- Books must be placed in order, so we can’t rearrange them.  
- For each position `i`, we try all possible splits `j..i` to see if books `j..i` fit on the same shelf.  
- We track the maximum height of that shelf and add it to the optimal solution for the prefix ending at `j-1`.  
- This ensures we explore all valid shelf configurations and pick the minimum total height.  

---

## Conclusion
The DP solution systematically explores all ways to split shelves while respecting order and width.  
It guarantees the minimum total height in **O(n²)** time and **O(n)** space, which is efficient for up to 1000 books.


---
