# 176. Second Highest Salary — Architectural SQL Solution  
*O(n) — Clean & Optimal*

---

## Problem Statement

Given table `Employee(id, salary)` where:

- `id` is **unique**
- `salary` may **repeat**

Return the **second highest distinct salary**.  
If it does not exist → return `NULL`.

---

## Core Idea — Two-Pass Max Filter

We need the **largest salary that is strictly less** than the **overall maximum**.

**Strategy**:
1. Compute `MAX(salary)` → highest salary
2. Find `MAX(salary)` **where** `salary <` that maximum
3. If no such row exists → result is `NULL`

This is **optimal** — no sorting, no window functions, no subquery hell.

---

## PostgreSQL Implementation

```sql
SELECT MAX(salary) AS SecondHighestSalary
FROM Employee
WHERE salary < (SELECT MAX(salary) FROM Employee);
```

## Alternative (MySQL — requires alias)

```sql
SELECT (
    SELECT DISTINCT salary 
    FROM Employee 
    ORDER BY salary DESC 
    LIMIT 1 OFFSET 1
) AS SecondHighestSalary;
```
## Why This Works

- `(SELECT MAX(salary) FROM Employee)` → returns the **highest salary**
- `WHERE salary < ...` → **excludes** the top salary (even if duplicated)
- `MAX()` on the filtered set → gives **second highest distinct**
- If no rows remain → `MAX()` returns **NULL** → **perfect**

**Handles duplicates automatically**  
**No need** for `DISTINCT`, `LIMIT`, `OFFSET`, or `ROW_NUMBER()`

---

## Complexity

| **Metric**     | **Value**   | **Notes**                          |
|----------------|-------------|------------------------------------|
| **Time**       | **O(n)**    | Two full table scans (optimal)     |
| **Space**      | **O(1)**    | No extra storage                   |

**Best possible** for this problem.

---

## Edge Cases

| **Input**                         | **Output** | **Reason**                             |
|-----------------------------------|------------|----------------------------------------|
| Only one employee                 | `NULL`     | No second salary                       |
| All same salary                   | `NULL`     | No strictly smaller salary             |
| Multiple with highest salary      | Correct    | `WHERE salary < max` excludes all max  |
| Two distinct salaries             | Correct    | Works perfectly                        |

---



