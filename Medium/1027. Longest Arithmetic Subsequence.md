# 1027. Longest Arithmetic Subsequence

---

## Problem Restatement
We are given an array `nums`.  
We need to find the length of the longest arithmetic subsequence.  

- A subsequence is formed by deleting some elements without changing order.  
- Arithmetic subsequence means the difference between consecutive elements is constant.  

---

## Key Idea
This is a **Dynamic Programming (DP)** problem.

### Step 1: State
Let `dp[i][diff]` = length of arithmetic subsequence ending at index `i` with common difference `diff`.

### Step 2: Transition
For each pair `(j, i)` with `j < i`:
- `diff = nums[i] - nums[j]`
- If `dp[j][diff]` exists, then:
```dp[i][diff] = dp[j][diff] + 1```
- Otherwise:
```dp[i][diff] = 2 // subsequence formed by nums[j], nums[i]```

### Step 3: Answer
Keep track of the maximum length across all states.

---

## Code (C#)
```csharp
public class Solution {
  public int LongestArithSeqLength(int[] nums) {
      int n = nums.Length;
      var dp = new Dictionary<int, int>[n];
      for (int i = 0; i < n; i++) {
          dp[i] = new Dictionary<int, int>();
      }

      int res = 2; // minimum arithmetic subsequence length is 2

      for (int i = 0; i < n; i++) {
          for (int j = 0; j < i; j++) {
              int diff = nums[i] - nums[j];
              int len = 2;
              if (dp[j].ContainsKey(diff)) {
                  len = dp[j][diff] + 1;
              }
              if (!dp[i].ContainsKey(diff)) {
                  dp[i][diff] = len;
              } else {
                  dp[i][diff] = Math.Max(dp[i][diff], len);
              }
              res = Math.Max(res, dp[i][diff]);
          }
      }

      return res;
  }
}
```


## Complexity
- **Time:** O(n²), because we evaluate all pairs `(j, i)` to build subsequences.  
- **Space:** O(n²) in the worst case, since each index may store many differences in its hashmap.  

---

## Example Walkthrough
**Input:** `nums = [9,4,7,2,10]`

- Pair (0,1): diff = -5 → subsequence `[9,4]`, length = 2  
- Pair (1,2): diff = 3 → subsequence `[4,7]`, length = 2  
- Pair (2,4): diff = 3 → extend `[4,7]` → `[4,7,10]`, length = 3  

**Answer = 3 ✅**

---

## Conclusion
The solution uses **dynamic programming with hashmaps per index**:  
- Each state tracks subsequences ending at that index with a given difference.  
- This ensures we can extend subsequences efficiently.  
- The approach runs in **O(n²)** and is practical for arrays up to `n ≤ 1000`.  


---
