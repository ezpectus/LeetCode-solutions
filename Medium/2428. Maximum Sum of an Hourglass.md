# 2428. Maximum Sum of an Hourglass  
*O(m × n) — Direct Enumeration of All Possible Hourglasses*

---

## Problem Statement

You are given an `m × n` integer matrix `grid`.

An **hourglass** is defined as a specific pattern of 7 cells in the matrix:
```
a b c
d
e f g
```

where:
- `a, b, c` are in row `i`
- `d` is in row `i+1`, column `j+1`
- `e, f, g` are in row `i+2`

You need to find the **maximum sum** of any such hourglass entirely contained in the grid.

**Examples**:

**Example 1**  
Input: grid = [[6,2,1,3],[4,2,1,5],[9,2,8,7],[4,1,2,9]]  
Output: **30**  
Hourglass with sum 6+2+1+2+9+2+8 = 30

**Example 2**  
Input: grid = [[1,2,3],[4,5,6],[7,8,9]]  
Output: **35**  
Only possible hourglass: 1+2+3+5+7+8+9 = 35

**Constraints**:
- 3 ≤ m, n ≤ 150
- 0 ≤ grid[i][j] ≤ 10⁶

---

## Core Idea — Brute Force Enumeration of All Positions

**Simple & efficient approach**:
- An hourglass is defined by its **top-left corner** (row i, column j)
- The hourglass covers rows i to i+2 and columns j to j+2
- It requires at least 3 rows and 3 columns
- For each possible top-left (i, j) where i ≤ m-3 and j ≤ n-3:
  - Compute sum of the 7 cells:
    - grid[i][j] + grid[i][j+1] + grid[i][j+2]
    - grid[i+1][j+1]
    - grid[i+2][j] + grid[i+2][j+1] + grid[i+2][j+2]
  - Keep track of the maximum sum

**Time**: O(m × n) — for each of (m-2) × (n-2) positions, sum 7 cells in O(1)  
**Space**: O(1) — no extra space needed

---

## Clean Implementation (C#)

```csharp
public class Solution{
    public int MaxSum(int[][] grid){
        int m = grid.Length;
        int n = grid[0].Length;
        int maxSum = int.MinValue;

        // Try every possible top-left position of hourglass
        for (int i = 0; i <= m - 3; i++){
            for (int j = 0; j <= n - 3; j++){
                int currentSum = 0;

                // Top row: 3 cells
                currentSum += grid[i][j] + grid[i][j + 1] + grid[i][j + 2];

                // Middle: 1 cell
                currentSum += grid[i + 1][j + 1];

                // Bottom row: 3 cells
                currentSum += grid[i + 2][j] + grid[i + 2][j + 1] + grid[i + 2][j + 2];
                maxSum = Math.Max(maxSum, currentSum);
            }
        }

        return maxSum;
    }
}
```

## Complexity

| **Metric**            | **Value**     | **Notes**                                      |
|-----------------------|---------------|------------------------------------------------|
| **Time Complexity**   | **O(m × n)**  | Number of possible hourglass positions: (m-2) × (n-2)<br>Each position: O(1) to sum the 7 fixed cells |
| **Space Complexity**  | **O(1)**      | Only a few integer variables — no extra arrays or data structures needed |

**Optimal** — linear in the size of the grid — very fast and efficient for m, n ≤ 150 (maximum ~150×150 = 22 500 positions, each constant time).

---

## Why This Works — Example Walkthrough

**Example 1**: grid = [[6,2,1,3],[4,2,1,5],[9,2,8,7],[4,1,2,9]]

**Possible hourglass top-left positions** (i from 0 to m-3=1, j from 0 to n-3=1):

- **i=0, j=0**:  
  cells: (0,0)=6, (0,1)=2, (0,2)=1, (1,1)=2, (2,0)=9, (2,1)=2, (2,2)=8  
  sum = 6 + 2 + 1 + 2 + 9 + 2 + 8 = **30**

- **i=0, j=1**:  
  cells: (0,1)=2, (0,2)=1, (0,3)=3, (1,2)=1, (2,1)=2, (2,2)=8, (2,3)=7  
  sum = 2 + 1 + 3 + 1 + 2 + 8 + 7 = **24**

- **i=1, j=0**:  
  cells: (1,0)=4, (1,1)=2, (1,2)=1, (2,1)=2, (3,0)=4, (3,1)=1, (3,2)=2  
  sum = 4 + 2 + 1 + 2 + 4 + 1 + 2 = **16**

- **i=1, j=1**:  
  cells: (1,1)=2, (1,2)=1, (1,3)=5, (2,2)=8, (3,1)=1, (3,2)=2, (3,3)=9  
  sum = 2 + 1 + 5 + 8 + 1 + 2 + 9 = **28**

**Maximum sum** among all possible hourglasses = **30** → correct

**Correct** —  
We simply enumerate **every possible valid position** for the top-left corner of the hourglass (must have at least 2 rows and 2 columns remaining below and to the right).  
For each such position, compute the sum of the **7 fixed cells** in constant time.  
Track the global maximum sum found.

---

## Key Takeaway

This is a **straightforward brute-force enumeration** problem with a fixed pattern:

* An hourglass is a **fixed 3×3 shape** with the middle-left and middle-right cells missing
* Valid positions = all top-left corners (i, j) where i ≤ m-3 and j ≤ n-3
* For each position:
  - Sum the 7 cells:  
    top row (3 cells) + middle center (1 cell) + bottom row (3 cells)
  - Update the maximum sum if larger
* Return the maximum sum found

---
